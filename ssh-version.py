from scapy.all import *

def ssh_version_banner_grab(ip):
    pkt = IP(dst=ip)/TCP(dport=22, flags='S')
    resp = sr1(pkt, timeout=2, verbose=False)
    if resp and resp.haslayer(TCP):
        pkt = IP(dst=ip)/TCP(dport=22, flags='A', ack=resp[TCP].seq+1)
        resp = sr1(pkt, timeout=2, verbose=False)
        if resp and resp.haslayer(Raw):
            print(f"SSH Version Banner for {ip}: {resp[Raw].load.decode()}")

ip = "192.168.1.10"
ssh_version_banner_grab(ip)
