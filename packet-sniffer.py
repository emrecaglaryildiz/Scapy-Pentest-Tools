from scapy.all import *

def packet_sniffer(pkt):
    if pkt.haslayer(IP):
        print(f"IP Packet: {pkt[IP].src} -> {pkt[IP].dst}")
    if pkt.haslayer(TCP):
        print(f"TCP Packet: {pkt[TCP].sport} -> {pkt[TCP].dport}")
    if pkt.haslayer(UDP):
        print(f"UDP Packet: {pkt[UDP].sport} -> {pkt[UDP].dport}")

sniff(prn=packet_sniffer)
