from scapy.all import *

def ack_scan(target_ip, target_port):
    ip = IP(dst=target_ip)
    tcp = TCP(dport=target_port, flags='A')
    packet = ip/tcp
    resp = sr1(packet, timeout=1, verbose=False)
    if resp and resp.haslayer(TCP) and resp.getlayer(TCP).flags == 0x4:
        print(f"Port {target_port} is unfiltered")
    else:
        print(f"Port {target_port} is filtered")

target_ip = "192.168.1.10"
target_port = 80
ack_scan(target_ip, target_port)
